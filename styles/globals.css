/* --- Tailwind & plugins --- */
@import "tailwindcss";
@import "tw-animate-css";
@plugin "@tailwindcss/typography";

/* --- Rich markdown defaults (uses tokens) --- */
.prose-md {
  @apply prose prose-slate dark:prose-invert max-w-none prose-lg
    prose-headings:scroll-m-20 prose-headings:font-semibold prose-headings:tracking-tight
    prose-h1:text-4xl prose-h1:lg:text-5xl prose-h1:border-b prose-h1:pb-4 prose-h1:mb-8
    prose-h2:text-3xl prose-h2:border-b prose-h2:pb-3 prose-h2:mt-12 prose-h2:mb-6
    prose-h3:text-2xl prose-h3:mt-8 prose-h3:mb-4
    prose-p:leading-7 prose-p:mb-4
    prose-blockquote:border-l-4 prose-blockquote:border-primary prose-blockquote:bg-muted/30 prose-blockquote:py-4 prose-blockquote:px-6 prose-blockquote:rounded-r-lg prose-blockquote:my-6
    prose-ul:my-6 prose-ul:ml-6 prose-li:mt-2
    prose-ol:my-6 prose-ol:ml-6
    prose-table:my-6 prose-table:border-collapse prose-table:border prose-table:border-border
    prose-th:border prose-th:border-border prose-th:bg-muted/50 prose-th:px-4 prose-th:py-3 prose-th:text-left prose-th:font-semibold
    prose-td:border prose-td:border-border prose-td:px-4 prose-td:py-3
    prose-hr:my-8 prose-hr:border-border
    prose-a:text-primary prose-a:font-medium prose-a:underline-offset-4 hover:prose-a:underline
    prose-strong:font-semibold prose-strong:text-foreground
    prose-em:italic prose-em:text-muted-foreground
    prose-img:rounded-lg prose-img:shadow-md prose-img:my-6;
}

/* --- Dark variant helper for utilities --- */
@custom-variant dark (&:is(.dark *));

/* --- Design tokens (light) --- */
:root {
  --background: oklch(1 0 0);
  --foreground: oklch(0.145 0 0);

  --card: oklch(1 0 0);
  --card-foreground: oklch(0.145 0 0);

  --popover: oklch(1 0 0);
  --popover-foreground: oklch(0.145 0 0);

  --primary: oklch(0.205 0 0);
  --primary-foreground: oklch(0.985 0 0);

  --secondary: oklch(0.97 0 0);
  --secondary-foreground: oklch(0.205 0 0);

  --muted: oklch(0.97 0 0);
  --muted-foreground: oklch(0.556 0 0);

  --accent: oklch(0.97 0 0);
  --accent-foreground: oklch(0.205 0 0);

  --destructive: oklch(0.577 0.245 27.325);
  --destructive-foreground: oklch(0.577 0.245 27.325);

  --border: oklch(0.922 0 0);
  --input: oklch(0.922 0 0);
  --ring: oklch(0.708 0 0);

  --chart-1: oklch(0.646 0.222 41.116);
  --chart-2: oklch(0.6 0.118 184.704);
  --chart-3: oklch(0.398 0.07 227.392);
  --chart-4: oklch(0.828 0.189 84.429);
  --chart-5: oklch(0.769 0.188 70.08);

  --radius: 0.625rem;

  --sidebar: oklch(0.985 0 0);
  --sidebar-foreground: oklch(0.145 0 0);
  --sidebar-primary: oklch(0.205 0 0);
  --sidebar-primary-foreground: oklch(0.985 0 0);
  --sidebar-accent: oklch(0.97 0 0);
  --sidebar-accent-foreground: oklch(0.205 0 0);
  --sidebar-border: oklch(0.922 0 0);
  --sidebar-ring: oklch(0.708 0 0);
}

.dark {
  /* Base surfaces */
  --background: oklch(0.17 0 0);        /* was 0.145 → a touch lighter */
  --foreground: oklch(0.985 0 0);

  /* Cards/popovers lifted above bg */
  --card: oklch(0.24 0 0);              /* was 0.20 */
  --card-foreground: oklch(0.98 0 0);
  --popover: oklch(0.24 0 0);
  --popover-foreground: oklch(0.98 0 0);

  /* Accents */
  --primary: oklch(0.85 0.15 80);       /* gold */
  --primary-foreground: oklch(0.15 0 0);
  --accent: oklch(0.85 0.15 80);
  --accent-foreground: oklch(0.15 0 0);

  /* Muted (panel fills, hover states) */
  --muted: oklch(0.28 0 0);              /* was 0.22 */
  --muted-foreground: oklch(0.82 0 0);   /* was 0.70 → better contrast */

  /* Secondary panel */
  --secondary: oklch(0.30 0 0);
  --secondary-foreground: oklch(0.98 0 0);

  /* Lines & focus */
  --border: oklch(0.46 0 0);            /* was 0.35 → clearer outlines */
  --input:  oklch(0.46 0 0);
  --ring:   oklch(0.78 0.13 80);        /* brighter golden focus */

  /* Charts etc. unchanged */
  --chart-1: oklch(0.65 0.22 41);
  --chart-2: oklch(0.60 0.12 184);
  --chart-3: oklch(0.77 0.18 70);
  --chart-4: oklch(0.62 0.26 303);
  --chart-5: oklch(0.64 0.24 16);

  /* Sidebar */
  --sidebar: oklch(0.22 0 0);
  --sidebar-foreground: oklch(0.98 0 0);
  --sidebar-border: oklch(0.46 0 0);
}

/* --- Global base --- */
@layer base {
  * { @apply border-border outline-ring/50; }
  body { @apply bg-background text-foreground; }
}

/* --- Token-aware defaults for content --- */
article { line-height: 1.7; color: var(--foreground); }
h1, h2, h3 { color: var(--foreground); }
code {
  background: color-mix(in oklch, var(--muted) 85%, transparent);
  padding: 0.15rem 0.35rem;
  border-radius: 0.25rem;
  border: 1px solid var(--border);
}

/* --- Components & utilities --- */
@layer components {
  .card-hover {
    @apply border-2 transition-all hover:-translate-y-0.5 hover:shadow-md hover:border-primary/40;
  }
  .card-media { @apply relative aspect-[4/3] overflow-hidden rounded-lg border; }
  .card-media > img { @apply h-full w-full object-cover transition-transform duration-300 group-hover:scale-[1.02]; }
  .line-clamp-2 { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
}

@layer components {
  .card-surface {
    @apply bg-[--card] border border-[--border] rounded-xl;
    /* subtle 2-layer shadow for dark surfaces */
    box-shadow:
      0 1px 0 0 rgba(255,255,255,.04) inset,
      0 0 0 1px rgba(0,0,0,.55),
      0 8px 24px -16px rgba(0,0,0,.8);
  }
  .card-hover {
    @apply transition-transform duration-200 hover:-translate-y-0.5 hover:border-[color-mix(in_oklch,var(--primary) 40%,var(--border))];
  }
}
@layer utilities {
  /* subtle section backgrounds so blocks don't look like floating islands */
  .bg-surface-1 { background: color-mix(in oklch, var(--background) 92%, white); }
  .bg-surface-2 { background: color-mix(in oklch, var(--card) 96%, white); }
}